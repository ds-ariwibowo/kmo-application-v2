
<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
    <h4 class="modal-title"><i class="icon-pencil font-dark"></i>&nbsp;<label id="titleModal" type="text" name="TitleModal" /> </h4>
    <div class="caption font-sm">
    </div>
</div>
        
    <div class="form-body">
        <div class="modal-body">

            <div class="portlet light bordered">
                <div class="portlet-body">

                    <table id="ecd" class="dt-responsive" width="100%" hidden>
                        <tbody>
                            <tr>
                                <td>

                                    <div class="m-grid m-grid-responsive-xs m-grid-demo">
                                        <div class="m-grid-row">
                                            <div class="m-grid-col m-grid-col-middle m-grid-col-center m-grid-col-md-1 border-top border-left border-right border-bottom padding-left" style="background-color:white">
                                                <img alt="" class="img-responsive" src="~/Theme/assets/layouts/layout4/img/png.jpg" />
                                            </div>
                                            <div class="m-grid-col m-grid-col-top m-grid-col-center m-grid-col-md-3 border-top border-left border-right border-bottom padding-top padding-bottom"><h2><b>UTL:ECD</b></h2><hr /><p>Utility : Electricity Consumption Distribution - Suite</p></div>
                                            <div class="m-grid-col m-grid-col-top m-grid-col-center m-grid-col-md-1 border-top border-left border-right border-bottom padding-top padding-bottom padding-left">
                                               
                                              Date<hr />
                                               <input class="form-control responsive input-small bold center-align " size="14" type="text" value="" id="ecddate" readonly />
                                                  
                                            </div>
                                            <div class="m-grid-col m-grid-col-top m-grid-col-center m-grid-col-md-1 border-top border-left border-right border-bottom padding-top padding-bottom">Document<hr />Revision<hr />Page</div>
                                            <div class="m-grid-col m-grid-col-top m-grid-col-center m-grid-col-md-1 border-top border-left border-right border-bottom padding-top padding-bottom">UTL:ECD-300<hr /><label id="rev"></label><hr />1</div>
                                        </div>
                                    </div>
                                    <br />
                                    <div class="m-grid m-grid-responsive-md m-grid-demo">
                                        <div class="m-grid-row">
                                            <div class="m-grid-col m-grid-col-middle m-grid-col-left m-grid-col-md-1 border-top border-left border-right border-bottom padding-left padding-right">
                                                <div class="form-group form-md-line-input">
                                                    <input type="text" readonly disabled class="form-control" id="c1" placeholder="-" value="">
                                                    <label for="form_control_1"><i>Floor Level</i></label>
                                                </div>
                                            </div>
                                            <div class="m-grid-col m-grid-col-middle m-grid-col-left m-grid-col-md-1 border-top border-left border-right border-bottom padding-left padding-right">
                                                <div class="form-group form-md-line-input">
                                                    <input type="text" readonly disabled class="form-control" id="c11" placeholder="-" value="">
                                                    <label for="form_control_1"><i>Suite Number</i></label>
                                                </div>
                                            </div>
                                            <div class="m-grid-col m-grid-col-top m-grid-col-left m-grid-col-md-1 border-top border-left border-right border-bottom padding-top padding-bottom padding-left padding-right">
                                                <div class="form-group form-md-line-input">
                                                    <input type="text" class="form-control date-picker bold" id="c2" name="name" placeholder="dd-MMM-yyyy" data-date-format="dd-M-yyyy">
                                                    <label for="form_control_1"><b>Capture Date</b></label>
                                                </div>
                                            </div>
                                            <div class="m-grid-col m-grid-col-top m-grid-col-left m-grid-col-md-1 border-top border-left border-right border-bottom padding-top padding-bottom padding-left padding-right">
                                                <div class="form-group form-md-line-input">
                                                    <input type="text" class="form-control bold" id="c3" name="number" onblur="parseToFloat(this);" placeholder="0" value="">
                                                    <label for="form_control_1"><b>AC Reading (kVA)</b></label>
                                                </div>
                                            </div>         
                                            <div class="m-grid-col m-grid-col-top m-grid-col-left m-grid-col-md-1 border-top border-left border-right border-bottom padding-top padding-bottom padding-left padding-right">
                                                <div class="form-group form-md-line-input">
                                                    <input type="text" class="form-control bold" id="c4" name="number" onblur="parseToFloat(this);" placeholder="0" value="">
                                                    <label for="form_control_1"><b>Non AC Reading (kVA)</b></label>
                                                </div>
                                            </div>         

                                        </div>
                                    </div>                                 
                                      
                                </td>
                            </tr>
                        </tbody>
                    </table>
                  
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <label hidden id="currentDate" class="bold">@DateTime.Now.ToString("dd-MMM-yyyy")</label>   
            <label hidden id="user" class="bold">@User.Identity.Name</label>              
       

            <button id="submit" type="submit" value="Save" class="btn green-soft">
                <i class="fa fa-check"></i> Submit
            </button>
            <button type="button" data-dismiss="modal" class="btn dark btn-outline"><i class="fa fa-close"></i> Cancel</button>
                                      
           </div>
        </div>

<script src="~/Theme/assets/pages/scripts/components-date-time-pickers.min.js" type="text/javascript"></script>
<script src="~/Theme/assets/pages/scripts/form-validation-md.min.js" type="text/javascript"></script>


<script type="text/javascript">

    function parseToFloat(selectedId) {
        var id = '#' + $(selectedId).attr('id');
        if (id == '#undefined') {
            if (selectedId.substr(0, 1) !== '#')
                id = '#' + selectedId;
            else
                id = selectedId;
        }      
        $(id).val(parseFloat(Number($(id).val().toString().replace(/[^0-9\.]+/g, ""))));
    }
    
    var FormInputMask = function () {
        var handleInputMasks = function () {
            $('#c3,#c4').inputmask('Regex', { regex: "^[0-9]{1,9}(\\.\\d{1,2})?$" });
        }
        return {
            //main function to initiate the module
            init: function () {
                handleInputMasks();
            }
        };
    }();
      

    var id = 0;
    $(document).ready(function () {
        App.startPageLoading({ animate: true });
        FormInputMask.init();

        $('#ecd').show();
        $('#ecddate').val($('#currentDate').text());
        $('#c1').val($('#floorId').text());
        $('#c11').val($('#suiteName').text());
        $('#c2').val($('#currentDate').text());
        $('#rev').text(1);
        App.stopPageLoading();
    });


    $("#submit").click(function () {

        if ($('#c4').val().trim() == '0') {
            $("#c4").focus();
            return;
        }
        if ($('#c3').val().trim() == '0') {
            $("#c3").focus();
            return;
        }
        if ($('#c2').val().trim() == '') {
            $("#c2").focus();
            return;
        } 
       
        App.startPageLoading({ animate: true });
     
        var model = {
            SuitId:  $('#suiteId').text(),
            FloorId: $('#floorId').text(),
            HoldingCompanyId: $('#holdingCompanyId').val(),
            Date:  $('#c2').val(),
            AcReading: parseFloat($('#c3').val()),
            AcUsages: 0,
            NonAcReading: parseFloat($('#c4').val()),
            NonAcUsages: 0,
            UserId: $('#user').text(),
            datestamp: $('#currentDate').text()
        };

        $.ajax({
            type: "POST",
            data: JSON.stringify(model),
            url: "/SuiteAvailabilityStatus/SubmitSuiteECD",
            contentType: "application/json"
        }).done(function (res) {
            App.stopPageLoading();
            if (res.length > 0) {
                bootbox.alert(res);
                return;
            }
            window.location.reload(true);
        });
        
    });


</script>